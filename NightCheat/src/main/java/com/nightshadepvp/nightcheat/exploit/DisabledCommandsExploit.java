package com.nightshadepvp.nightcheat.exploit;

import com.google.common.collect.ImmutableList;
import com.nightshadepvp.core.Rank;
import com.nightshadepvp.core.entity.NSPlayer;
import org.bukkit.entity.Player;
import org.bukkit.event.EventHandler;
import org.bukkit.event.player.PlayerCommandPreprocessEvent;

import java.util.List;

public class DisabledCommandsExploit extends Exploit {

    private List<String> bannedCommands;

    public DisabledCommandsExploit() {
        super("Disabled Commands");
        this.setViolationsToNotify(1);
        bannedCommands = ImmutableList.of("//calc", "//calculate", "/me", "/say", "");
    }


    @EventHandler
    public void onPreProcess(PlayerCommandPreprocessEvent event) {
        Player player = event.getPlayer();
        NSPlayer nsPlayer = NSPlayer.get(player);
        if (nsPlayer.hasRank(Rank.ADMIN)) return; //bypass
        for (String string : bannedCommands) {
            if (event.getMessage().startsWith(string)) {
                event.setCancelled(true);
                flag(player, this, "Attempted to use a banned command (" + string + ")");
                break;
            }
        }
    }
}
